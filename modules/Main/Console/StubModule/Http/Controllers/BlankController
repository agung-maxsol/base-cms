<?php
namespace Module\Blank\Http\Controllers;

use Module\Main\Http\Repository\CrudRepository;
use Module\Main\Http\Controllers\AdminBaseController;
use Module\Blank\Http\Skeleton\BlankSkeleton;
use Module\Main\Transformer\Exportable;
use Module\Main\Contracts\WithRevision;

class BlankController extends AdminBaseController implements WithRevision
{
	use Exportable;
	public $hint = 'blank';

	public function repo(){
		return $this->hint;
	}

	public function skeleton(){
		return new BlankSkeleton;
	}

	public function afterValidation($mode='create', $instance=null){

	}

	public function afterCrud($instance){

	}

	public function image_field(){
		return ['image'];
	}


	//untuk override store format. default : by struktur model
	public function storeRevisionFormat($instance){
		return null;
	}

	//manage revision shown fields
	public function reformatRevision($data=[]){
		return [
			'id' => $data['id'],
			'Title' => $data['title'],
			'Description' => descriptionMaker($data['description']),
			'Updated' => date('d M Y H:i:s', strtotime($data['updated_at']))
		];
	}

	//revision activate condition
	public function activateRevision($instance, $revision_data=[]){
		//dynamically restore revision data
		foreach($revision_data as $field => $value){
			if(in_array($field, ['id', 'created_at', 'updated_at', 'is_active'])){
				continue;
			}
			$instance->{$field} = $value;
		}
		$instance->save();
	}

}